                  <meta charset="utf-8">
                  **Report: Final**
            Ben Drews (bfd2@williams.edu)
            Diego Gonzalez (drg4@williams.edu)
            Lylia Li (ll5@williams.edu)
            Youle Chen (yc2@williams.edu)

![Image that sells our project](evocativescene.png)

Introduction 
==================================
Our program allows users to edit a scene in real time by adding or removing voxels to the scene. Users can choose from a number of differently colored or textured voxels to add to the scene. Also, users are able to change the color/textures of existing voxels in the scene. Finally, users can apply interesting transformations to the voxels in the scene, like making craters, raising mountains, and digging caves. The program is compatible with virtual reality headsets and controlers, and the user can move around in the scene they created.

Specification
==================================
**Features of the program:**

1. User is able to place and destroy a variety of different voxel types in real time
    - Voxels are 0.5 x 0.5 x 0.5 m
    - Voxels can be added to an unlimited space, but the number of voxels that can be added is capped at 10,000.
    - Models are edited without writing to disk
    - Option to save your model is available

2. Program is compatible with virtual reality headsets and controllers, and the user can move around in 3D space

3. User is able to apply interesting transforms to the voxels in the scene, for example:
    - Making a crater in the world
    - Raising mountains
    - Digging caves
    - Ideally these wouldn't happen instantaneously (we want to see the mountain being raised)
    - Button user interface (on game controls) that determine what operation we are performing on the scene

4. User is able to change how the world is scaled

5. Voxel painting
    - Existing set of voxels with 16 different textures to choose from when adding to scene
    - Textures can be mildly transparent
    - User can change the color/texture of any voxel that has already been placed in the scene

6. Virtual Reality User Interface
    - When you grip the left controller, a control panel with all of the voxel types pops up in the scene in the user's left hand that the user can interact with by pointing at it with the right controller and pulling the trigger

7. Non-VR User Interface
    - Use G3D debug camera for head position
    - User navigates the world by moving the mouse (the camera movements are controlled by the mouse)
    - User places or destroys voxels by left clicking the mouse
    - When you press 'p', a control panel with all of the voxel types pops up in the scene that the user can interact with using the mouse

8. Rendering
    - Use G3D built-in renderer: There will be shadows but no indirect lighting

9. Audio
    - Sound effects for placing voxels and destroying voxels

**Stretch goals:**

1. Implement marching cubes algorithm to make smooth surfaces

2. Add visual user interface in VR

3. Add physics simulation so we can throw voxels around

4. Import MagicaVoxel objects as templates

5. Make data structures more efficient


**Program evaluation metric:**

1. What is the maximum amount of voxels in the scene before noticeable performance decay?

2. What kinds of transformations can be applied to the scene?

3. Are these transformations easily repeatable? (Are the controls understandable)

Topic Overview 
==================================

Voxel world editors have become quite common since the advent of Minecraft. For our project, we want to use this archetype and combine it with the VR experience. Our goal is to give users the impression that they are shaping the world with their motions. 


Design
==================================

One ArticulatedModel, m_model, to hold all of the voxels.
m_model has different geometries and meshes for each chunk, and there are different chunks for each type (voxel material).

Why add Point3(0.5, 0.5, 0.5) when getting vox to world space positions?

Our program will work by having a main controller which creates an ArticulatedModel representing the entire voxel world. We will use a hashmap from integer positions to voxel type IDs and color masks to store a compact representation of this world. Along with a hashmap from voxel type ids to voxel properties, these data structures will be used to turn the user's input into the appropriate edits of the main ArticulatedModel.

**Major functions of App: Voxel geometry**
 Function             | Description                                                
 ---------------------|------------------------------------------------------------
 initializeModel      | Initializes an ArticulatedModel that will be edited at runtime when user input is received
 initializeMaterials  | ---
 addVoxelModelToScene | ---
 addVoxel             | Based on position and type of voxel received from user input, uses m_voxToProp to add a voxel to the scene by modifying the main ArticulatedModel, and updates m_posToVox
 addFace              | ---
 removeVoxel          | Based on position received from user input, removes the voxel at that position from the scene by modifying the main ArticulatedModel, and updates m_posToVox
 removeFace           | ---
 paintVoxel           | Based on position and type of voxel received from user input, uses m_posToVox to locate an existing voxel in the scene and uses m_voxToProp to change the texture/color of the selected voxel

**Major functions of App: User interface**
 Function             | Description                                                
 ---------------------|------------------------------------------------------------
 initializePlayer     | ---
 movePlayer           | ---


Correctness Results
=====================================================
Debugging images we will need:

- Empty scene with each of the different voxel types

- Empty scene with non-VR user interface

- Empty scene with VR user interface


Placeholder Quality Images
=====================================================
**Aesthetic goals**
![](1.png width=500px) ![](2.png width=500px)

![](3.png width=500px) ![](4.png width=500px)

**Implementation goals**

[Chunks](http://store.steampowered.com/app/402800/)

[SculptrVR](http://store.steampowered.com/app/418520/)

![](https://www.youtube.com/watch?v=wiz92cCL0m8)

![0:00-0:003: UI goals for VR](https://www.youtube.com/watch?v=qoJzrnNoD5I)

![Template for UI for different colored/textured blocks](5.png)

**Stretch goals**

![Implementing Cube Marching would allow us to render smooth surfaces](6.png)


Evocative Result
==================================
![Evocative result.](evocativescene.png)


Schedule
==================================

 Task                 | Description                                                | Date          | 
----------------------|------------------------------------------------------------|--------------:|
 ArticulatedModel     | Get an ArticulatedModel to show up in the scene, be able to modify it at runtime (Ben, Lylia) | 11/14 |
 VR Controls          | Learn about how VR controls work and how to get inputs from VR controllers (Diego, Youle) | 11/15 |

**TO DO:**

- Add materials with G3D materials (Lylia)
    - Method to paint voxels (change the texture of a voxel)
    - One articulated model per material
- Swap to ray-grid intersect (Youle)

- Use firstPersonManipulator for camera instead of debug camera (Diego)

*UI*
- Switch between materials (Lylia)
    - Panel with small voxels of differnt textures protruding from it
    - Use scene intersect to interact with the "buttons"
    - Highlight the one that's currently selected
- Visualize selections (Ben)
    - selection entity moves with controller in VR
    - selection entity moves with mouse in non VR
    - Array of current selections is highlighted/glows
    - ** STRETCH GOAL: ** Highlight a selection with the VR control laser and have everything in the selection be highlighted (by changing the texture?)

**Speed up**
- Make add voxel method for large sections 
- Remove voxel 


Change Log
==================================
1. May have to reconsider max number of voxels in the scene depending on how much optimization we can do
2. May also have to reduce number of materials to choose from depending again on how much faster we can get our program to run


<!-- Markdeep: -->
<style class="fallback">body{visibility:hidden;white-space:pre;font-family:monospace;}</style><script src="https://casual-effects.com/markdeep/latest/markdeep.min.js"></script><script>window.alreadyProcessedMarkdeep||(document.body.style.visibility="visible")</script>
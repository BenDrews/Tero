                  <meta charset="utf-8">
                 **Development Journal**
                   Ben Drews (bfd2@williams.edu)
                   Diego Gonzalez (drg4@williams.edu)
                   Lylia Li (ll5@williams.edu)
                   Youle Chen (yc2@williams.edu)


2016-11-17: How to use an ArticulatedModel
====================================================
After conferring with our fearless instructor Morgan McGuire, we were told that it's really really slow to have each voxel have its own geometry and mesh, so we restructured our program so that all of the vertices of all the voxels in the scene are added to the same geometry. However, adding many voxels at one time is still extremely slow. For example, it takes a very long time to initialize the ground or copy large sections of existing voxels.


2016-11-17: Material initialization
====================================================
To have voxels of different textures, we want to have a set of existing materials to map voxel types to. To do this we have to initialize all the materials at the start of the program. We are currently trying to create a UniversalMaterial from an Any, but we can't use PARSE_ANY because the file name for the texture of each material will be different, so we can't just type it in, we need to generate a new String for each material. We tried creating an Any from a string, but the UniversalMaterial::create method is currently reading that Any just as a String and not as an Any, so it thinks that the filename is the whole Any.

 
2016-11-17: Circle Selection
====================================================
Added hooks for selecting a cyclindric section of voxels with the 'l' key press. You can then elevate a selection by holding down 'u' and dragging the mouse. The copying done by the elevateSection method takes a concerningly long time.

![Circle Selection](CircleSelection.jpg)


2016-11-16: Ground
=====================================================
Added in initial ground:

![](Ground.jpg)

Something concerning here is that with 400 voxels, there is slight but noticable lag when moving about the scene. When a 10,000 voxel scene was attempted, by the time the 500th voxel was being added, addVoxel was taking a nontrivial amount of time. If we want to have 10,000 voxels possible, there needs to be some multithreading/optimizations. 

2016-11-16: Removing Voxels
=====================================================
Initially we tried to only have visible voxel faces represented in the geometry. We wanted to remove adjacent faces when adding voxels to the scene, but we encountered errors causing faces to be missing from the voxel we are currently adding and existing faces to disappear from existing voxels when we add to the scene.

![When we add voxels, faces are missing and other faces disappear](additions.png)

![](buggyAdd.png)

![The scene from below before adding a voxel to the bottom](beforeAdd.png) ![The scene from below after adding a voxel to the bottom](afterAdd.png)

We discovered that there was a mistake in how the voxel geometries were being named by addVoxel. Currently we are trying to work out a bug with removeFace, where the code is not even being compiled, in spite of the breakpoint set at the line calling removeFace being hit. 

Additionally the 'raymarch' is giving us problems, in that voxels are often placed in areas where the mouse is not. We tried dividing the mouseXY positions by the window dimensions and then multiplying by the renderDevice dimensions, but that did not seem to help at all. Likely there is some mismatch of window dimensions and renderDevice dimensions leading to a misguided ray. Perhaps we should just intersect the scene with the built in G3d method.


2016-11-16: Adding user input (Diego)
=====================================================
At first I tried to make a player entity that set the camera and moved around, but I realized that this infrastructure would have to work with the vr side of this all, so I decided to postpone that until we knew how the vr would work and simply use the debug camera.

I added user input so that whenever the user presses space, a voxel is placed next to an existing voxel. This intersection was done using ray marching and it works fairly well. There are some innaccuracies however, so perhaps another intersection method should be implemented in the future. Ben had an idea for an analytical intersection but we still need to hash out that idea a bit more.

At first, the intersect ray that we were casting was through the center of the screen, but without a crosshair, this was difficult to aim. Now the intersect ray is dependent on the mouse position. This still has issues but is more accurate.

2016-11-16: Adding GUI and Texture
=====================================================
Raymarching from the debug camera position, and see if it hits a voxel. Pressing the space key adds a voxel at the position. 

Trying to implement cross hair.
Added in Textcoord0 for texture. Basically each point on the face of the voxel is assigned a Point2 value with x and y being either 0 or 1.

2016-11-14: Implementing addVoxel
=====================================================
We reused Youle's code for adding voxel faces given the center of a voxel and the normal of the face.

Given the center of a voxel in voxel space (where positions are all integers), addVoxel checks if there is already a voxel adjacent to it in every direction. For each direction, if there is no adjacent voxel, it adds a face in that direction.

![Here, the centers of each face are not being calculated correctly.](firstAddVox.png)

Then we had the addFace method take the center of the voxel and a normal, and using that, calculated where each vertex of the face should be.
We add those vertices to the CPUVertexArray of our member ArticulatedModel, and then add the indices of those vertices to the CPUIndexArray.

![Now all the faces are in the right place, but the indexing of the vertices of each face is not correct.](betterAddVoxel.png)

![Using his voxel expertise, Youle fixed the indexing and we can successfully add a voxel to our scene!](bestAddVoxel.png)

2016-11-14: Adding ArticulatedModel to scene
=====================================================
Worked on creating an ArticulatedModel and adding it to the scene as a VisibleEntity at runtime. We had trouble getting the model to actually show up, but we realized it was because when we were adding vertices to the CPUVertexArray, we kept rewriting the same single vertex instead of adding new vertices.
                   
Placeholder Quality Images
=====================================================
**Aesthetic goals**
![](1.png width=500px) ![](2.png width=500px)

![](3.png width=500px) ![](4.png width=500px)

**Implementation goals**

[Chunks](http://store.steampowered.com/app/402800/)

[SculptrVR](http://store.steampowered.com/app/418520/)

![](https://www.youtube.com/watch?v=wiz92cCL0m8)

![0:00-0:003: UI goals for VR](https://www.youtube.com/watch?v=qoJzrnNoD5I)

**Stretch goals**

![Implementing Cube Marching would allow us to render smooth surfaces](6.png)

<!-- Markdeep: -->
<style class="fallback">body{visibility:hidden;white-space:pre;font-family:monospace;}</style><script src="https://casual-effects.com/markdeep/latest/markdeep.min.js"></script><script>window.alreadyProcessedMarkdeep||(document.body.style.visibility="visible")</script><!DOCTYPE html>